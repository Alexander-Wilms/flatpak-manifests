{
	"app-id": "com.play0ad.zeroad",
	"runtime": "org.freedesktop.Platform",
	"runtime-version": "1.6",
	"sdk": "org.freedesktop.Sdk",
	"command": "0ad",
	"rename-icon": "0ad",
	"rename-desktop-file": "0ad.desktop",
	"rename-appdata-file": "0ad.appdata.xml",
	"finish-args":[
		"--socket=wayland",
		"--socket=x11",
		"--socket=pulseaudio",
		"--share=network",
		"--device=dri",
		"--filesystem=~/.local/share/0ad/:create",
		"--filesystem=~/.config/0ad/:create",
		"--filesystem=~/.cache/0ad/:create"
	],
	"modules":[
		{
			"name": "libogg",
			"sources": [
				{
					"type": "archive",
					"url": "http://downloads.xiph.org/releases/ogg/libogg-1.3.2.tar.xz",
					"sha256": "3f687ccdd5ac8b52d76328fbbfebc70c459a40ea891dbf3dccb74a210826e79b"
				}
			]
		},
		{
			"name": "libvorbis",
			"sources": [
				{
					"type": "archive",
					"url": "http://downloads.xiph.org/releases/vorbis/libvorbis-1.3.5.tar.xz",
					"sha256": "54f94a9527ff0a88477be0a71c0bab09a4c3febe0ed878b24824906cd4b0e1d1"
				}
			]
		},
    {
        "name": "openal",
        "buildsystem": "cmake",
        "cleanup": [ "/bin" ],
        "config-opts": [],
        "sources": [
            {
                "type": "archive",
                "url": "http://kcat.strangesoft.net/openal-releases/openal-soft-1.17.2.tar.bz2",
                "sha256": "a341f8542f1f0b8c65241a17da13d073f18ec06658e1a1606a8ecc8bbc2b3314"
            }
        ]
    },
		{
		  "name": "boost",
		  "buildsystem": "simple",
		  "sources":
		  [
		    {
		      "type": "archive",
		      "url": "https://downloads.sourceforge.net/project/boost/boost/1.60.0/boost_1_60_0.tar.bz2",
		      "sha256": "686affff989ac2488f79a97b9479efb9f2abae035b5ed4d8226de6857933fd3b"
		    }
		  ],
		  "build-commands": ["./bootstrap.sh --prefix=/app --with-libraries=filesystem", "./b2 headers", "./b2 install"]
		},
		{
			"name": "gloox",
			"sources": [
				{
					"type": "archive",
					"url": "https://camaya.net/download/gloox-1.0.20.tar.bz2",
					"sha256": "0243086c0f4f0440d6d8e55705f83249a4463a1d75a034be42b5312e8886dea8"
				}
			]
		},
		{
			"name": "enet",
			"sources": [
				{
					"type": "archive",
					"url": "http://enet.bespin.org/download/enet-1.3.13.tar.gz",
					"sha256": "e36072021faa28731b08c15b1c3b5b91b911baf5f6abcc7fe4a6d425abada35c"
				}
			]
		},
		{
			"name": "miniupnpc",
			"buildsystem": "simple",
			"sources": [
				{
					"type": "archive",
					"url": "https://github.com/miniupnp/miniupnp/archive/miniupnpc_2_0.tar.gz",
					"sha256": "253a0ea5fe8f17d9f79f8758e1b6415d6a560e58bf3e9b5dbe714413dc908446"
				}
			],
			"build-commands": ["cd miniupnpc && mkdir build && cd build && cmake -DCMAKE_INSTALL_PREFIX=/app .. && make install"]
		},
		{

			"name": "0ad",
			"buildsystem": "simple",
			"sources":[
				{
					"type":"archive",
					"url": "http://releases.wildfiregames.com/0ad-0.0.21-alpha-unix-build.tar.xz",
					"sha256": "96be23e4284a3931ef9536f988f2517040bde1f8700ee048bff18c932d8683cf"
				},
				{
					"type":"archive",
					"url": "http://releases.wildfiregames.com/0ad-0.0.21-alpha-unix-data.tar.xz",
					"sha256": "f3ab3c58ffd3bd647a9baba93ea009d5945d2b5bc7db7053a547e07db36faa97"
				}
			],
			"build-commands":[
			"cd build/workspaces && ./update-workspaces.sh -j3 --disable-atlas --bindir=/app/bin --libdir=/app/lib --datadir=/app/share/games/0ad/ && cd gcc && make -j3"],
			"post-install": [
			"mkdir --parents /app/share/games/0ad",
			"mkdir --parents /app/lib/games/0ad",
			"mkdir --parents /app/games",
			"mkdir --parents /app/share/metainfo",
			"mkdir --parents /app/share/applications",
			"mkdir --parents /app/share/icons/hicolor/128x128/apps",
			"mv binaries/data/l10n                  /app/share/games/0ad/",
			"mv binaries/system/pyrogenesis         /app/bin/",
			"mv binaries/system/lib*             		/app/lib/",
			"mv build/resources/0ad.appdata.xml     /app/share/metainfo/",
			"mv build/resources/0ad.desktop         /app/share/applications/",
			"mv build/resources/0ad.png             /app/share/icons/hicolor/128x128/apps",
			"mv build/resources/0ad.sh							/app/bin/0ad",
			"chmod +x 															/app/bin/0ad",
			"mv	binaries/data/mods     							/app/share/games/0ad/",
			"mv	binaries/data/config    						/app/share/games/0ad/",
			"mv	binaries/data/tools	  							/app/share/games/0ad/"],
			"cleanup": ["/include"]
		}
	]
}
